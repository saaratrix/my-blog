<!doctype html>
<html>
<head>
    <title></title>
</head>
<body>
<p>
    This is a guide on how to set up debugging in a Blender Add-on version 2.80 or higher using PyCharm.
    I used this guide: <a href="https://code.blender.org/2015/10/debugging-python-code-with-pycharm/">https://code.blender.org/2015/10/debugging-python-code-with-pycharm/</a>
    to set up debugging.
    <br>
    <strong>Important: You need Pycharm Professional for debugging Blender because it requires the remote debugging feature which isn't available in community edition in 2019 or lower.</strong>
</p>
<!--more-->
<div id="toc" class="hide"></div>
<div id="contents">
    <h1>
        1. Install the remote_debugger Blender add-on
    </h1>
    <p>
        <strong><a href="https://github.com/sybrenstuvel">Sybren A. St√ºvel</a></strong> has developed a Blender Add-on called <strong>Remote debugger</strong> which is what makes the remote debugging possible.
        The add-on can be found here:
        <a href="https://github.com/sybrenstuvel/random-blender-addons/blob/master/remote_debugger.py">https://github.com/sybrenstuvel/random-blender-addons/blob/master/remote_debugger.py</a>.
        <br>
    </p>
    <p>
        After downloading the file, do these steps in Blender: <code>open preferences menu -> Add-ons -> Install... -> Select the remote_debugger.py file -> Click install Add-on</code>
        <br>
        <a href="https://3.bp.blogspot.com/-kZmC0mdWfpE/XmlLZDUiDJI/AAAAAAAAAUU/4wDPzcVrFwIDjh1menvI_4_dhRQFOk5BQCLcBGAsYHQ/s1600/debugger_installing.png" imageanchor="1" ><img border="0" src="https://3.bp.blogspot.com/-kZmC0mdWfpE/XmlLZDUiDJI/AAAAAAAAAUU/4wDPzcVrFwIDjh1menvI_4_dhRQFOk5BQCLcBGAsYHQ/s320/debugger_installing.png" width="320" height="126" data-original-width="1070" data-original-height="422" /></a>
    </p>
    <p>
        I created a folder called <strong>remote_debugger</strong> in my Blender Add-on project so I can easily find the file if I need it again.
    </p>
    <h1>
        2. Configure the add-on with the pycharm.egg file.
    </h1>
    <p>
        Now that the remote_debugger add-on is installed we need to tell the add-on where the PyCharm egg file is.
        For me that was at:
        <br>
        <code>C:\Programming\Jetbrains\apps\PyCharm-P\ch-0\193.6494.30\debug-eggs\pydevd-pycharm.egg</code> .
        <br>
        <a href="https://3.bp.blogspot.com/-ugcZ-77B6KQ/XmVIfealQBI/AAAAAAAAATU/IbNTZ7gifhUq1IcrGgGtFwxTBlU2PkuOACLcBGAsYHQ/s1600/debugger_pycharmegg_location.png" imageanchor="1" ><img border="0" src="https://3.bp.blogspot.com/-ugcZ-77B6KQ/XmVIfealQBI/AAAAAAAAATU/IbNTZ7gifhUq1IcrGgGtFwxTBlU2PkuOACLcBGAsYHQ/s320/debugger_pycharmegg_location.png" width="320" height="190" data-original-width="979" data-original-height="582" /></a>
    </p>
    <h1>
        3. Create the PyCharm debug configuration.
    </h1>
    <p>
        To create the remote debug configuration in PyCharm:
        <br>
        <code>Run -> Edit Configurations ... -> Expand Templates -> Python Remote Debug -> Set port to 1090 -> Click Create Configuration -> Change the name from "Unnamed"</code>
        <br>
        <a href="https://1.bp.blogspot.com/-jFXIvIa36so/XmVIwP_Yr3I/AAAAAAAAATY/N4VSHwqBjb0byy5DKh_zdKyYw5Aq_qkDgCLcBGAsYHQ/s1600/debugger_create_remote_debugger.png" imageanchor="1" ><img border="0" src="https://1.bp.blogspot.com/-jFXIvIa36so/XmVIwP_Yr3I/AAAAAAAAATY/N4VSHwqBjb0byy5DKh_zdKyYw5Aq_qkDgCLcBGAsYHQ/s320/debugger_create_remote_debugger.png" width="320" height="204" data-original-width="1078" data-original-height="686" /></a>
    </p>
    <p>
        If you need to edit the configuration go to <code>Edit Configurations ...</code> again to change the name, edit port or the local host name.
    </p>
    <h1>
        4. Run the PyCharm debug configuration
    </h1>
    <p>
        The next step is to start the remote debugger so that PyCharms listens for <code>pydevd_pycharm.settrace()</code> statements in the code.
        Just click <code>Run -> Debug ...</code> and then choose the configuration you created in the previous step.
        In the future you can just click <code>Run -> Debug "name"</code> to quickly start it.
        <br>
        <a href="https://4.bp.blogspot.com/-7TdE1r7_5pk/XmVI7aDIqqI/AAAAAAAAATg/SO6MPxEpRdEMB-lTjv7nG8Ua5G0xP5VKgCLcBGAsYHQ/s1600/debugger_run_debug.png" imageanchor="1" ><img border="0" src="https://4.bp.blogspot.com/-7TdE1r7_5pk/XmVI7aDIqqI/AAAAAAAAATg/SO6MPxEpRdEMB-lTjv7nG8Ua5G0xP5VKgCLcBGAsYHQ/s320/debugger_run_debug.png" width="247" height="320" data-original-width="351" data-original-height="455" /></a>
    </p>
    <h1>
        5. Connect to remote debugger in Blender
    </h1>
    <p>
        This is where we need to use the remote_debugger add-on in Blender to connect to PyCharm.
        With default keyboard settings you'd do the following where F3 is the "Search Menu" keymap binding:
        <br>
        <code>F3 -> search for "pycharm" -> Select "Connect to remote PyCharm debugger"</code>
        <br>
        Then the Blender freezes for about a second and it should show up in PyCharm that something has connected and you will see a lot of the console output of Blender.
        <br>
        <a href="https://3.bp.blogspot.com/-tWc1_Dp4ZXs/XmVJDMBw48I/AAAAAAAAATk/9N0FsKipUp0XC0s110Jo3K-Qj7Q5OLPGACLcBGAsYHQ/s1600/debugger_activate_in_blender.png" imageanchor="1" ><img border="0" src="https://3.bp.blogspot.com/-tWc1_Dp4ZXs/XmVJDMBw48I/AAAAAAAAATk/9N0FsKipUp0XC0s110Jo3K-Qj7Q5OLPGACLcBGAsYHQ/s320/debugger_activate_in_blender.png" width="320" height="187" data-original-width="688" data-original-height="401" /></a>
    </p>
    <p>
        This is how it looks like when I connected from Blender to PyCharm:
        <br>
        <a href="https://1.bp.blogspot.com/-600U9ndSy58/XmVPFRY5ftI/AAAAAAAAAUA/3cjdjluQOwkhjdNgW52e9llnTgRD115RwCLcBGAsYHQ/s1600/debugger_connected_to_pycharm.png" imageanchor="1" ><img border="0" src="https://1.bp.blogspot.com/-600U9ndSy58/XmVPFRY5ftI/AAAAAAAAAUA/3cjdjluQOwkhjdNgW52e9llnTgRD115RwCLcBGAsYHQ/s320/debugger_connected_to_pycharm.png" width="320" height="298" data-original-width="810" data-original-height="754" /></a>
    </p>
    <p>
        When I upgraded from Pycharm 2019.3 to 2020.1 the debugger stopped working for me.
        It gave me the error <strong>Expected: C:\...\debug-eggs\pydevd-pycharm.egg\pydevd_attach_to_process\attach_amd64.dll to exist.</strong>
        This was solved by renaming the <strong>.egg</strong> file to <strong>.zip</strong> and unzip the content and then rename that folder to <strong>pydevd-pycharm.egg</strong>.
        <br>
        More information: <a href="https://youtrack.jetbrains.com/issue/PY-43558">https://youtrack.jetbrains.com/issue/PY-43558</a>
        <br>
        <a href="https://1.bp.blogspot.com/-cMbNcsFVeww/X6GY6DAMAAI/AAAAAAAAAXY/4ehNhkJFvZoNaFh9Y-ES_R4dI3Oq-FArQCLcBGAsYHQ/s0/pydevd-pycharm.egg-folder.png" imageanchor="1">
            <img alt="" border="0" data-original-height="124" data-original-width="670" src="https://1.bp.blogspot.com/-cMbNcsFVeww/X6GY6DAMAAI/AAAAAAAAAXY/4ehNhkJFvZoNaFh9Y-ES_R4dI3Oq-FArQCLcBGAsYHQ/s0/pydevd-pycharm.egg-folder.png"/>
        </a>
    </p>
    <h1>
        6. Add pydevd_pycharm.settrace() in code
    </h1>
    <p>
        All that's left is to add <code>import pydevd_pycharm; pydevd_pycharm.settrace()</code> in the code and a breakpoint will happen and you can debug the code and step over or into functions and so on.
        The reason for inlining <code>import pydevd_pycharm;</code> before calling the <code>settrace()</code> method is that if you declare it at the top of the file, then blender might throw an import module error.
        <br>
        <a href="https://1.bp.blogspot.com/-BxSXAP5cXVI/X6Ga-YcvDVI/AAAAAAAAAXk/Vm_EfPDAN84SLV_O0yAR7-5ZLCh48g1SwCPcBGAYYCw/s482/debugger_set_breakpoint.png" imageanchor="1" ><img border="0" src="https://1.bp.blogspot.com/-BxSXAP5cXVI/X6Ga-YcvDVI/AAAAAAAAAXk/Vm_EfPDAN84SLV_O0yAR7-5ZLCh48g1SwCPcBGAYYCw/s600/debugger_set_breakpoint.png" width="320" height="257" data-original-width="461" data-original-height="370" /></a>
    </p>
    <p>
        This is how it looked like in PyCharm for me when the breakpoint was hit and trying to see what value the variable <code>layout</code> had:
        <br>
        <a href="https://4.bp.blogspot.com/-Sc5HA_VuJoE/XmVP8ogw7_I/AAAAAAAAAUI/vUB_hcvEjbEJMB4BRc8BZM_uH4itNaQAQCLcBGAsYHQ/s1600/debugger_breakpoint_activated.png" imageanchor="1" ><img border="0" src="https://4.bp.blogspot.com/-Sc5HA_VuJoE/XmVP8ogw7_I/AAAAAAAAAUI/vUB_hcvEjbEJMB4BRc8BZM_uH4itNaQAQCLcBGAsYHQ/s320/debugger_breakpoint_activated.png" width="320" height="295" data-original-width="833" data-original-height="768" /></a>
    </p>
    <h1>More reading</h1>
    <p>
        Other Blender Add-on related blog posts by me that may be of interest:
    </p>
    <ul>
        <li>
            <a href="/2020/02/create-blender-add-on-project-with.html">Create a Blender Add-on project with PyCharm</a>
        </li>
        <li>
            <a href="/2020/01/easily-reloading-blender-addon.html">Reload modified 2.80 Blender Add-on</a>
        </li>
        <li>
            <a href="/2020/02/how-to-add-blender-add-on-preferences.html">How to add user preferences for a Blender Add-on</a>
        </li>
    </ul>
</div>
</body>
</html>
